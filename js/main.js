var app;!function(e){var t;!function(e){var t=function(){function e(e,t,i,o){this.playArea=e,this.height=i,this.width=t,this.velocity=o,this.body=document.createElement("div"),this.body.style.right=-1*this.width+"px",this.body.style.width=this.width+"px",this.body.style.height=this.height+"px",this.body.style.bottom="0",this.body.className="enemy"}return e.prototype.release=function(e){var t=this;void 0===e&&(e=0),setTimeout(function(){t.playArea.appendChild(t.body),TweenLite.to(t.body,1*t.velocity,{right:"768px",onComplete:t.destroy.bind(t)})},1e3*e)},e.prototype.destroy=function(){TweenMax.killTweensOf(this.body),this.playArea.removeChild(this.body)},e}();e.Abstract=t}(t=e.game||(e.game={}))}(app||(app={}));var app;!function(e){var t;!function(e){var t=function(){function e(){}return e.detectCollition=function(e,t){return e.x<t.x+t.w&&e.x+e.w>t.x&&e.y<t.y+t.h&&e.h+e.y>t.y},e.debounce=function(e,t,i){var o;return function(){var n=this,a=arguments,l=function(){o=null,i||e.apply(n,a)},s=i&&!o;clearTimeout(o),o=setTimeout(l,t),s&&e.apply(n,a)}},e.throttle=function(e,t,i){void 0===t&&(t=250);var o,n;return function(){var a=i||this,l=+new Date,s=arguments;o&&o+t>l?(clearTimeout(n),n=setTimeout(function(){o=l,e.apply(a,s)},t)):(o=l,e.apply(a,s))}},e}();e.Utils=t}(t=e.game||(e.game={}))}(app||(app={}));var app;!function(e){var t;!function(t){var i=e.game.Utils,o=function(){function e(e,t){var o=this;this._isJumping=!1,this.shoot=i.throttle(function(){if(o.isDead)return void o.msgDead();var e=document.createElement("div");e.className="bullet",e.style.width="10px",e.style.height="10px",e.style.bottom=parseInt(o.body.style.bottom)+25+"px",o.playArea.appendChild(e),TweenLite.to(e,5.75,{right:-20,onComplete:function(){TweenMax.killTweensOf(e),o.playArea.removeChild(e)}}),console.log("shoot")},500),this.applyForce=i.throttle(function(){return o.isDead?void o.msgDead():(o.forceJump=o.forceJump<1?o.forceJump+.1:1,TweenMax.killTweensOf(o.body),void TweenMax.to(o.body,.25,{height:50-20*o.forceJump}))},1),this.jump=i.debounce(function(){return o.isJumping||o.isDead?void o.msgDead():(o.isJumping=!0,void TweenMax.to(o.body,2*o.forceJump,{height:"80px",bottom:420*o.forceJump,onComplete:function(){TweenMax.to(o.body,1.6*o.forceJump,{height:"50px",bottom:0,onComplete:function(){o.isJumping=!1,o.forceJump=0}})}}))},250),this.playArea=e,this.body=document.getElementById(t),this.body.style.bottom="0px",this.body.style.width="50px",this.body.style.height="50px",this.body.style.right="708px",this.forceJump=0,this.isDead=!1}return e.prototype.msgDead=function(){console.log("ESTAS MUERTO! No te puedes jugar mas!.")},e.prototype.dead=function(){this.isDead=!0,this.body.style.backgroundColor="black",console.log("YOU DIE!!!!")},Object.defineProperty(e.prototype,"isJumping",{get:function(){return this._isJumping},set:function(e){this._isJumping=e},enumerable:!0,configurable:!0}),e}();t.Player=o}(t=e.game||(e.game={}))}(app||(app={}));var app;!function(e){var t;!function(e){var t=function(){function t(e,t){this.player=t,this.playArea=e,this.start()}return t.prototype.start=function(){var t=this;setInterval(function(){var i={x:parseInt(t.player.body.style.right),y:parseInt(t.player.body.style.bottom),w:parseInt(t.player.body.style.width),h:parseInt(t.player.body.style.height),e:t.player.body},o=t.playArea.getElementsByClassName("enemy");if(o.length>0)for(var n=0;n<o.length;n++){var a=o[n],l={x:parseInt(a.style.right),y:parseInt(a.style.bottom),w:parseInt(a.style.width),h:parseInt(a.style.height),e:a};e.Utils.detectCollition(l,i)&&(console.log("POW!"),t.player.dead())}var s=t.playArea.getElementsByClassName("obstacle");if(s.length>0)for(var n=0;n<s.length;n++){var r=s[n],l={x:parseInt(r.style.right),y:parseInt(r.style.bottom),w:parseInt(r.style.width),h:parseInt(r.style.height),e:r};!t.player.isDead&&e.Utils.detectCollition(l,i)&&(console.log("PAM!"),t.player.dead());var p=t.playArea.getElementsByClassName("bullet");if(p.length>0)for(var n=0;n<p.length;n++){var h=p[n],y={x:parseInt(h.style.right),y:parseInt(h.style.bottom),w:parseInt(h.style.width),h:parseInt(h.style.height),e:h};e.Utils.detectCollition(l,y)&&(console.log("CRASH!"),TweenMax.killTweensOf(l.e),t.playArea.removeChild(l.e),TweenMax.killTweensOf(y.e),t.playArea.removeChild(y.e))}}},1)},t}();e.Ticker=t}(t=e.game||(e.game={}))}(app||(app={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},app;!function(e){var t;!function(t){var i=function(e){function t(t,i,o,n){void 0===i&&(i=10),void 0===o&&(o=10),void 0===n&&(n=.5),e.call(this,t,i,o,n),this.body.style.bottom="0",this.body.className="enemy"}return __extends(t,e),t}(e.game.Abstract);t.Enemy=i}(t=e.game||(e.game={}))}(app||(app={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},app;!function(e){var t;!function(t){var i=function(e){function t(t,i,o,n){void 0===i&&(i=10),void 0===o&&(o=10),void 0===n&&(n=.5),e.call(this,t,i,o,n),this.body.style.bottom=500-this.height+"px",this.body.className="obstacle"}return __extends(t,e),t}(e.game.Abstract);t.Obstacle=i}(t=e.game||(e.game={}))}(app||(app={}));var levels=[[{type:"obstacle",time:.2,width:10,height:500,velocity:5},{type:"obstacle",time:3,width:10,height:400,velocity:5},{type:"obstacle",time:6,width:10,height:120,velocity:5}],[{type:"enemy",time:.2,width:10,height:300,velocity:5},{type:"obstacle",time:2,width:10,height:100,velocity:3},{type:"obstacle",time:5,width:20,height:430,velocity:4}],[{type:"obstacle",time:.2,width:10,height:200,velocity:5},{type:"enemy",time:.2,width:10,height:200,velocity:5},{type:"obstacle",time:5.2,width:10,height:350,velocity:5},{type:"enemy",time:5.2,width:10,height:100,velocity:5}]],app;!function(e){var t;!function(t){var i=e.game.Enemy,o=e.game.Obstacle,n=function(){function e(e){this.playArea=e}return e.prototype.load=function(e){if(void 0===e&&(e=0),console.log("Load LVL -> ",e),1>e||e>levels.length)return!1;e-=1;for(var t=0;t<levels[e].length;t++){var n,a=levels[e][t];switch(a.type){case"enemy":n=new i(this.playArea,a.width,a.height,a.velocity);break;case"obstacle":n=new o(this.playArea,a.width,a.height,a.velocity)}n.release(a.time)}return!0},e}();t.LevelSelector=n}(t=e.game||(e.game={}))}(app||(app={}));var app;!function(e){var t;!function(t){var i=e.game.Player,o=e.game.Ticker,n=e.game.LevelSelector,a=function(){function e(){this.btPlay=document.getElementById("js-bt-play"),this.btReload=document.getElementById("js-bt-reload"),this.playArea=document.getElementById("js-canvas"),this.player=new i(this.playArea,"js-player"),this.ticker=new o(this.playArea,this.player),this.levelSelector=new n(this.playArea),this.isPlaying=!1}return e.prototype.start=function(){this.bindings()},e.prototype.bindings=function(){var e=this;this.btPlay.onclick=this.play.bind(this),this.btReload.onclick=this.reload.bind(this),document.body.onkeydown=function(t){switch(t.preventDefault(),t.which){case 74:e.player.isJumping||e.player.applyForce();break;case 70:e.player.shoot();break;default:return}},document.body.onkeyup=function(t){t.preventDefault(),74==t.which&&e.player.jump()}},e.prototype.reload=function(){location.reload()},e.prototype.play=function(){this.releaseLevels()},e.prototype.releaseLevels=function(){var e=this;this.isPlaying||(this.isPlaying=!0,setTimeout(function(){e.levelSelector.load(1)},100),setTimeout(function(){e.levelSelector.load(2)},12e3),setTimeout(function(){e.levelSelector.load(3)},2e4))},e}();t.App=a}(t=e.game||(e.game={}))}(app||(app={}));var App=app.game.App,walkAloneApp;!function(){walkAloneApp=new App,walkAloneApp.start()}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkFic3RyYWN0LnRzIiwiVXRpbHMudHMiLCJQbGF5ZXIudHMiLCJtYWluLmpzIiwiVGlja2VyLnRzIiwiRW5lbXkudHMiLCJPYnN0YWNsZS50cyIsIkxldmVsU2VsZWN0b3IudHMiLCJBcHAudHMiLCJtYWluLnRzIl0sIm5hbWVzIjpbImFwcCIsImdhbWUiLCJBYnN0cmFjdCIsInBsYXlBcmVhIiwid2lkdGgiLCJoZWlnaHQiLCJ2ZWxvY2l0eSIsInRoaXMiLCJib2R5IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50Iiwic3R5bGUiLCJyaWdodCIsImJvdHRvbSIsImNsYXNzTmFtZSIsInByb3RvdHlwZSIsInJlbGVhc2UiLCJ0aW1lb3V0IiwiX3RoaXMiLCJzZXRUaW1lb3V0IiwiYXBwZW5kQ2hpbGQiLCJUd2VlbkxpdGUiLCJ0byIsIm9uQ29tcGxldGUiLCJkZXN0cm95IiwiYmluZCIsIlR3ZWVuTWF4Iiwia2lsbFR3ZWVuc09mIiwicmVtb3ZlQ2hpbGQiLCJVdGlscyIsImRldGVjdENvbGxpdGlvbiIsInJlY3QxIiwicmVjdDIiLCJ4IiwidyIsInkiLCJoIiwiZGVib3VuY2UiLCJmdW5jIiwid2FpdCIsImltbWVkaWF0ZSIsImNvbnRleHQiLCJhcmdzIiwiYXJndW1lbnRzIiwibGF0ZXIiLCJhcHBseSIsImNhbGxOb3ciLCJjbGVhclRpbWVvdXQiLCJ0aHJvdHRsZSIsInRocmVzaGhvbGQiLCJzY29wZSIsImxhc3QiLCJkZWZlclRpbWVyIiwibm93IiwiRGF0ZSIsIlBsYXllciIsImVsZW1lbnROYW1lIiwiX2lzSnVtcGluZyIsInNob290IiwiaXNEZWFkIiwibXNnRGVhZCIsImJ1bGxldCIsInBhcnNlSW50IiwiY29uc29sZSIsImxvZyIsImFwcGx5Rm9yY2UiLCJmb3JjZUp1bXAiLCJqdW1wIiwiaXNKdW1waW5nIiwiZ2V0RWxlbWVudEJ5SWQiLCJkZWFkIiwiYmFja2dyb3VuZENvbG9yIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXQiLCJzZXQiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwiVGlja2VyIiwicGxheWVyIiwic3RhcnQiLCJzZXRJbnRlcnZhbCIsInJlY3RQbGF5ZXIiLCJlIiwiZW5lbWllcyIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJsZW5ndGgiLCJpIiwiZWxFbmVteSIsIm9ic3RhY2xlcyIsImVsT2JzdGFjbGUiLCJidWxsZXRzIiwiZWxCdWxsZXQiLCJfX2V4dGVuZHMiLCJkIiwiYiIsIl9fIiwiY29uc3RydWN0b3IiLCJwIiwiaGFzT3duUHJvcGVydHkiLCJjcmVhdGUiLCJFbmVteSIsIl9zdXBlciIsImNhbGwiLCJPYnN0YWNsZSIsImxldmVscyIsInR5cGUiLCJ0aW1lIiwiTGV2ZWxTZWxlY3RvciIsImxvYWQiLCJsdmwiLCJvYmplY3QiLCJ2YWx1ZSIsIkFwcCIsImJ0UGxheSIsImJ0UmVsb2FkIiwidGlja2VyIiwibGV2ZWxTZWxlY3RvciIsImlzUGxheWluZyIsImJpbmRpbmdzIiwib25jbGljayIsInBsYXkiLCJyZWxvYWQiLCJvbmtleWRvd24iLCJwcmV2ZW50RGVmYXVsdCIsIndoaWNoIiwib25rZXl1cCIsImxvY2F0aW9uIiwicmVsZWFzZUxldmVscyIsIndhbGtBbG9uZUFwcCJdLCJtYXBwaW5ncyI6IkFBRUEsR0FBT0EsTUFBUCxTQUFPQSxHQUFJLEdBQUFDLElBQUEsU0FBQUEsR0FFUCxHQUFBQyxHQUFBLFdBUUksUUFBQUEsR0FBYUMsRUFBdUJDLEVBQWVDLEVBQWdCQyxHQUUvREMsS0FBS0osU0FBV0EsRUFDaEJJLEtBQUtGLE9BQVNBLEVBQ2RFLEtBQUtILE1BQVFBLEVBQ2JHLEtBQUtELFNBQVdBLEVBRWhCQyxLQUFLQyxLQUFPQyxTQUFTQyxjQUFlLE9BRXBDSCxLQUFLQyxLQUFLRyxNQUFNQyxNQUF1QixHQUFiTCxLQUFLSCxNQUFlLEtBQzlDRyxLQUFLQyxLQUFLRyxNQUFNUCxNQUFRRyxLQUFLSCxNQUFRLEtBQ3JDRyxLQUFLQyxLQUFLRyxNQUFNTixPQUFTRSxLQUFLRixPQUFT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UixXQUNJbEgsS0FBS3lILGlCQUdEZixFQUFBbEcsVUFBQWlILGNBQVIsV0FBQSxHQUFBOUcsR0FBQVgsSUFFUUEsTUFBSytHLFlBRVQvRyxLQUFLK0csV0FBWSxFQUVqQm5HLFdBQVksV0FDUkQsRUFBS21HLGNBQWNSLEtBQUssSUFDekIsS0FFSDFGLFdBQVksV0FDUkQsRUFBS21HLGNBQWNSLEtBQUssSUFDekIsTUFFSDFGLFdBQVksV0FDUkQsRUFBS21HLGNBQWNSLEtBQUssSUFDekIsT0FFWEksSUF4RmFoSCxHQUFBZ0gsSUFBR0EsR0FQVGhILEVBQUFELEVBQUFDLE9BQUFELEVBQUFDLFdBQUpELE1BQUFBLFFDSFAsSUFBT2lILEtBQU1qSCxJQUFJQyxLQUFLZ0gsSUFDbEJnQixjQUVKLFdBRUNBLGFBQWUsR0FBSWhCLEtBQ25CZ0IsYUFBYWpEIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiZGVmaW5pdGlvbnMvZ3JlZW5zb2NrL2dyZWVuc29jay5kLnRzXCIgLz5cblxubW9kdWxlIGFwcC5nYW1lIHtcbiAgICBcbiAgICBleHBvcnQgY2xhc3MgQWJzdHJhY3Qge1xuICAgICAgICBcbiAgICAgICAgcHJvdGVjdGVkIHBsYXlBcmVhOiBIVE1MRWxlbWVudDtcbiAgICAgICAgcHJvdGVjdGVkIGJvZHk6IEhUTUxFbGVtZW50O1xuICAgICAgICBwcm90ZWN0ZWQgaGVpZ2h0OiBudW1iZXI7XG4gICAgICAgIHByb3RlY3RlZCB3aWR0aDogbnVtYmVyO1xuICAgICAgICBwcm90ZWN0ZWQgdmVsb2NpdHk6IG51bWJlcjtcbiAgICAgICAgIFxuICAgICAgICBjb25zdHJ1Y3RvciggcGxheUFyZWE6IEhUTUxFbGVtZW50LCB3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlciwgdmVsb2NpdHk6IG51bWJlcikge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLnBsYXlBcmVhID0gcGxheUFyZWE7XG4gICAgICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDsgXG4gICAgICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7IFxuICAgICAgICAgICAgdGhpcy52ZWxvY2l0eSA9IHZlbG9jaXR5O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLmJvZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLmJvZHkuc3R5bGUucmlnaHQgPSAoIHRoaXMud2lkdGggKiAtMSApICsgJ3B4JztcbiAgICAgICAgICAgIHRoaXMuYm9keS5zdHlsZS53aWR0aCA9IHRoaXMud2lkdGggKyAncHgnO1xuICAgICAgICAgICAgdGhpcy5ib2R5LnN0eWxlLmhlaWdodCA9IHRoaXMuaGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLmJvZHkuc3R5bGUuYm90dG9tID0gJzAnO1xuICAgICAgICAgICAgdGhpcy5ib2R5LmNsYXNzTmFtZSA9ICdlbmVteSc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJlbGVhc2UgKCB0aW1lb3V0OiBudW1iZXIgPSAwICk6IHZvaWQge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5QXJlYS5hcHBlbmRDaGlsZCggdGhpcy5ib2R5ICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgVHdlZW5MaXRlLnRvKHRoaXMuYm9keSwgMSAqIHRoaXMudmVsb2NpdHksIHsgcmlnaHQ6ICc3NjhweCcsIG9uQ29tcGxldGU6IHRoaXMuZGVzdHJveS5iaW5kKHRoaXMpIH0pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSwgdGltZW91dCAqIDEwMDAgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgZGVzdHJveSAoKTogdm9pZCB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIFR3ZWVuTWF4LmtpbGxUd2VlbnNPZih0aGlzLmJvZHkpO1xuICAgICAgICAgICAgdGhpcy5wbGF5QXJlYS5yZW1vdmVDaGlsZCh0aGlzLmJvZHkpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgIH1cbn0iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiSVJlY3QudHNcIiAvPlxuXG5tb2R1bGUgYXBwLmdhbWUge1xuXG4gICAgaW1wb3J0IElSZWN0ID0gYXBwLmdhbWUuSVJlY3Q7XG4gICAgXG4gICAgZXhwb3J0IGNsYXNzIFV0aWxzIHtcbiAgICAgICAgXG4gICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvR2FtZXMvVGVjaG5pcXVlcy8yRF9jb2xsaXNpb25fZGV0ZWN0aW9uXG4gICAgICAgIHN0YXRpYyBkZXRlY3RDb2xsaXRpb24oIHJlY3QxOiBJUmVjdCwgcmVjdDI6IElSZWN0KTogYm9vbGVhbiB7XG5cbiAgICAgICAgICAgIGlmIChyZWN0MS54IDwgcmVjdDIueCArIHJlY3QyLncgJiZcbiAgICAgICAgICAgICAgICByZWN0MS54ICsgcmVjdDEudyA+IHJlY3QyLnggJiZcbiAgICAgICAgICAgICAgICByZWN0MS55IDwgcmVjdDIueSArIHJlY3QyLmggJiZcbiAgICAgICAgICAgICAgICByZWN0MS5oICsgcmVjdDEueSA+IHJlY3QyLnkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaHR0cHM6Ly9kYXZpZHdhbHNoLm5hbWUvamF2YXNjcmlwdC1kZWJvdW5jZS1mdW5jdGlvblxuICAgICAgICBzdGF0aWMgZGVib3VuY2UoZnVuYzogRnVuY3Rpb24sIHdhaXQ6IG51bWJlciwgaW1tZWRpYXRlPzogYm9vbGVhbik6IEZ1bmN0aW9uIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIHRpbWVvdXQ6IG51bWJlcjtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLCBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgICAgICAgICAgIHZhciBsYXRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGltZW91dCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaW1tZWRpYXRlKSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXQ7XG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0KTtcblxuICAgICAgICAgICAgICAgIGlmIChjYWxsTm93KXtcbiAgICAgICAgICAgICAgICAgICAgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaHR0cHM6Ly9yZW15c2hhcnAuY29tLzIwMTAvMDcvMjEvdGhyb3R0bGluZy1mdW5jdGlvbi1jYWxsc1xuICAgICAgICBzdGF0aWMgdGhyb3R0bGUoIGZ1bmM6IEZ1bmN0aW9uLCB0aHJlc2hob2xkOiBudW1iZXIgPSAyNTAsIHNjb3BlPzogYW55ICkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgbGFzdDogbnVtYmVyO1xuICAgICAgICAgICAgdmFyIGRlZmVyVGltZXI6IG51bWJlcjtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29udGV4dCA9IHNjb3BlIHx8IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm93ID0gK25ldyBEYXRlO1xuICAgICAgICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgICAgICAgICAgIGlmIChsYXN0ICYmIG5vdyA8IGxhc3QgKyB0aHJlc2hob2xkKSB7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBob2xkIG9uIHRvIGl0XG4gICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChkZWZlclRpbWVyKTtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdCA9IG5vdztcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgICAgICAgICAgICAgIH0sIHRocmVzaGhvbGQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxhc3QgPSBub3c7XG4gICAgICAgICAgICAgICAgICAgIGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiZGVmaW5pdGlvbnMvZ3JlZW5zb2NrL2dyZWVuc29jay5kLnRzXCIgLz5cblxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIlV0aWxzLnRzXCIgLz5cblxubW9kdWxlIGFwcC5nYW1lIHtcbiAgICBcbiAgICBpbXBvcnQgVXRpbHMgPSBhcHAuZ2FtZS5VdGlscztcbiAgICBcbiAgICBleHBvcnQgY2xhc3MgUGxheWVyIHtcbiAgICAgICAgXG4gICAgICAgIGJvZHk6IEhUTUxFbGVtZW50O1xuICAgICAgICBcbiAgICAgICAgcHJvdGVjdGVkIHBsYXlBcmVhOiBIVE1MRWxlbWVudDtcbiAgICAgICAgcHJpdmF0ZSBmb3JjZUp1bXA6IG51bWJlcjtcbiAgICAgICAgaXNEZWFkOiBib29sZWFuO1xuICAgICAgICBwcml2YXRlIF9pc0p1bXBpbmc6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgICAgICBjb25zdHJ1Y3RvciAoIHBsYXlBcmVhOiBIVE1MRWxlbWVudCwgZWxlbWVudE5hbWU6IHN0cmluZyApIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5wbGF5QXJlYSA9IHBsYXlBcmVhO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLmJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggZWxlbWVudE5hbWUgKTtcbiAgICAgICAgICAgIHRoaXMuYm9keS5zdHlsZS5ib3R0b20gPSAnMHB4JztcbiAgICAgICAgICAgIHRoaXMuYm9keS5zdHlsZS53aWR0aCA9ICc1MHB4JztcbiAgICAgICAgICAgIHRoaXMuYm9keS5zdHlsZS5oZWlnaHQgPSAnNTBweCc7XG4gICAgICAgICAgICB0aGlzLmJvZHkuc3R5bGUucmlnaHQgPSAnNzA4cHgnOyAvL3BvcnF1ZSBubyBsZWZ0PyBwYXJhIGNvbXBhcmFyIGNvbiAncmlnaHQnIGRlIG9ic3RhY3Vsb3MgbyBlbmVtaWdvc1xuICAgIFxuICAgICAgICAgICAgdGhpcy5mb3JjZUp1bXAgPSAwO1xuICAgICAgICAgICAgdGhpcy5pc0RlYWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcHJpdmF0ZSBtc2dEZWFkKCk6IHZvaWQge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnRVNUQVMgTVVFUlRPISBObyB0ZSBwdWVkZXMganVnYXIgbWFzIS4nKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgc2hvb3QgPSBVdGlscy50aHJvdHRsZSggKCkgPT4ge1xuICAgICAgICAgXG4gICAgICAgICAgICBpZiggdGhpcy5pc0RlYWQgKXtcbiAgICAgICAgICAgICAgICB0aGlzLm1zZ0RlYWQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9IFxuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgYnVsbGV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RpdicgKTtcbiAgICAgICAgICAgIGJ1bGxldC5jbGFzc05hbWUgPSAnYnVsbGV0JztcbiAgICAgICAgICAgIGJ1bGxldC5zdHlsZS53aWR0aCA9ICcxMHB4JztcbiAgICAgICAgICAgIGJ1bGxldC5zdHlsZS5oZWlnaHQgPSAnMTBweCc7XG4gICAgICAgICAgICBidWxsZXQuc3R5bGUuYm90dG9tID0gIHBhcnNlSW50KHRoaXMuYm9keS5zdHlsZS5ib3R0b20pICsgMjUgKyAncHgnO1xuICAgICAgICAgICAgdGhpcy5wbGF5QXJlYS5hcHBlbmRDaGlsZCggYnVsbGV0ICk7XG4gICAgICAgICAgICBUd2VlbkxpdGUudG8oYnVsbGV0LCA1Ljc1LCB7cmlnaHQ6IC0yMCwgb25Db21wbGV0ZTooKSA9PiB7XG4gICAgICAgICAgICAgICAgVHdlZW5NYXgua2lsbFR3ZWVuc09mKCBidWxsZXQgKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBsYXlBcmVhLnJlbW92ZUNoaWxkKCBidWxsZXQgKTtcbiAgICAgICAgICAgIH0gfSk7XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzaG9vdCcpOyAgIFxuICAgICAgICB9LCA1MDAgKTtcbiAgICAgICAgXG4gICAgICAgIGFwcGx5Rm9yY2UgPSBVdGlscy50aHJvdHRsZSggKCkgPT4ge1xuXG4gICAgICAgICAgICBpZiggdGhpcy5pc0RlYWQgKXtcbiAgICAgICAgICAgICAgICB0aGlzLm1zZ0RlYWQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMuZm9yY2VKdW1wID0gdGhpcy5mb3JjZUp1bXAgPCAxID8gdGhpcy5mb3JjZUp1bXAgKyAwLjEgOiAxO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBUd2Vlbk1heC5raWxsVHdlZW5zT2YodGhpcy5ib2R5KTtcbiAgICAgICAgICAgIFR3ZWVuTWF4LnRvKHRoaXMuYm9keSwgMC4yNSwge2hlaWdodDogNTAgLSAoMjAgKiB0aGlzLmZvcmNlSnVtcCl9KTtcbiAgICAgICAgfSwgMSApO1xuICAgICAgICBcbiAgICAgICAganVtcCA9IFV0aWxzLmRlYm91bmNlKCAoKSA9PiB7XG5cbiAgICAgICAgICAgIGlmKCB0aGlzLmlzSnVtcGluZyB8fCB0aGlzLmlzRGVhZCApe1xuICAgICAgICAgICAgICAgIHRoaXMubXNnRGVhZCgpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0gXG5cbiAgICAgICAgICAgIHRoaXMuaXNKdW1waW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgVHdlZW5NYXgudG8odGhpcy5ib2R5LCAyICogdGhpcy5mb3JjZUp1bXAsIHsgaGVpZ2h0OiAnODBweCcsIGJvdHRvbTogNDIwICogdGhpcy5mb3JjZUp1bXAsIG9uQ29tcGxldGU6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBUd2Vlbk1heC50byh0aGlzLmJvZHksIDEuNiAqIHRoaXMuZm9yY2VKdW1wLCB7IGhlaWdodDogJzUwcHgnLCBib3R0b206IDAsIG9uQ29tcGxldGU6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNKdW1waW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9yY2VKdW1wID0gMDtcbiAgICAgICAgICAgICAgICB9IH0gKTtcbiAgICAgICAgICAgIH0gfSk7XG4gICAgICAgIH0sIDI1MCApO1xuICAgICAgICBcbiAgICAgICAgZGVhZCAoKTogdm9pZCB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMuaXNEZWFkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuYm9keS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnYmxhY2snO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1lPVSBESUUhISEhJyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHNldCBpc0p1bXBpbmcgKCBpc0p1bXBpbmc6Ym9vbGVhbiApIHsgdGhpcy5faXNKdW1waW5nID0gaXNKdW1waW5nOyB9XG4gICAgICAgIGdldCBpc0p1bXBpbmcgKCkgeyByZXR1cm4gdGhpcy5faXNKdW1waW5nIH0gXG4gICAgfVxufSIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJkZWZpbml0aW9ucy9ncmVlbnNvY2svZ3JlZW5zb2NrLmQudHNcIiAvPlxudmFyIGFwcDtcbihmdW5jdGlvbiAoYXBwKSB7XG4gICAgdmFyIGdhbWU7XG4gICAgKGZ1bmN0aW9uIChnYW1lKSB7XG4gICAgICAgIHZhciBBYnN0cmFjdCA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBBYnN0cmFjdChwbGF5QXJlYSwgd2lkdGgsIGhlaWdodCwgdmVsb2NpdHkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsYXlBcmVhID0gcGxheUFyZWE7XG4gICAgICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgICAgICAgICAgICAgIHRoaXMudmVsb2NpdHkgPSB2ZWxvY2l0eTtcbiAgICAgICAgICAgICAgICB0aGlzLmJvZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJvZHkuc3R5bGUucmlnaHQgPSAodGhpcy53aWR0aCAqIC0xKSArICdweCc7XG4gICAgICAgICAgICAgICAgdGhpcy5ib2R5LnN0eWxlLndpZHRoID0gdGhpcy53aWR0aCArICdweCc7XG4gICAgICAgICAgICAgICAgdGhpcy5ib2R5LnN0eWxlLmhlaWdodCA9IHRoaXMuaGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgICAgICB0aGlzLmJvZHkuc3R5bGUuYm90dG9tID0gJzAnO1xuICAgICAgICAgICAgICAgIHRoaXMuYm9keS5jbGFzc05hbWUgPSAnZW5lbXknO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQWJzdHJhY3QucHJvdG90eXBlLnJlbGVhc2UgPSBmdW5jdGlvbiAodGltZW91dCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgaWYgKHRpbWVvdXQgPT09IHZvaWQgMCkgeyB0aW1lb3V0ID0gMDsgfVxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wbGF5QXJlYS5hcHBlbmRDaGlsZChfdGhpcy5ib2R5KTtcbiAgICAgICAgICAgICAgICAgICAgVHdlZW5MaXRlLnRvKF90aGlzLmJvZHksIDEgKiBfdGhpcy52ZWxvY2l0eSwgeyByaWdodDogJzc2OHB4Jywgb25Db21wbGV0ZTogX3RoaXMuZGVzdHJveS5iaW5kKF90aGlzKSB9KTtcbiAgICAgICAgICAgICAgICB9LCB0aW1lb3V0ICogMTAwMCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgQWJzdHJhY3QucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgVHdlZW5NYXgua2lsbFR3ZWVuc09mKHRoaXMuYm9keSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5QXJlYS5yZW1vdmVDaGlsZCh0aGlzLmJvZHkpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBBYnN0cmFjdDtcbiAgICAgICAgfSgpKTtcbiAgICAgICAgZ2FtZS5BYnN0cmFjdCA9IEFic3RyYWN0O1xuICAgIH0pKGdhbWUgPSBhcHAuZ2FtZSB8fCAoYXBwLmdhbWUgPSB7fSkpO1xufSkoYXBwIHx8IChhcHAgPSB7fSkpO1xuXG5cblxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIklSZWN0LnRzXCIgLz5cbnZhciBhcHA7XG4oZnVuY3Rpb24gKGFwcCkge1xuICAgIHZhciBnYW1lO1xuICAgIChmdW5jdGlvbiAoZ2FtZSkge1xuICAgICAgICB2YXIgVXRpbHMgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gVXRpbHMoKSB7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL0dhbWVzL1RlY2huaXF1ZXMvMkRfY29sbGlzaW9uX2RldGVjdGlvblxuICAgICAgICAgICAgVXRpbHMuZGV0ZWN0Q29sbGl0aW9uID0gZnVuY3Rpb24gKHJlY3QxLCByZWN0Mikge1xuICAgICAgICAgICAgICAgIGlmIChyZWN0MS54IDwgcmVjdDIueCArIHJlY3QyLncgJiZcbiAgICAgICAgICAgICAgICAgICAgcmVjdDEueCArIHJlY3QxLncgPiByZWN0Mi54ICYmXG4gICAgICAgICAgICAgICAgICAgIHJlY3QxLnkgPCByZWN0Mi55ICsgcmVjdDIuaCAmJlxuICAgICAgICAgICAgICAgICAgICByZWN0MS5oICsgcmVjdDEueSA+IHJlY3QyLnkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvLyBodHRwczovL2Rhdmlkd2Fsc2gubmFtZS9qYXZhc2NyaXB0LWRlYm91bmNlLWZ1bmN0aW9uXG4gICAgICAgICAgICBVdGlscy5kZWJvdW5jZSA9IGZ1bmN0aW9uIChmdW5jLCB3YWl0LCBpbW1lZGlhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGltZW91dDtcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29udGV4dCA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYXRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpbW1lZGlhdGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXQ7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgICAgICAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQobGF0ZXIsIHdhaXQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2FsbE5vdykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy8gaHR0cHM6Ly9yZW15c2hhcnAuY29tLzIwMTAvMDcvMjEvdGhyb3R0bGluZy1mdW5jdGlvbi1jYWxsc1xuICAgICAgICAgICAgVXRpbHMudGhyb3R0bGUgPSBmdW5jdGlvbiAoZnVuYywgdGhyZXNoaG9sZCwgc2NvcGUpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhyZXNoaG9sZCA9PT0gdm9pZCAwKSB7IHRocmVzaGhvbGQgPSAyNTA7IH1cbiAgICAgICAgICAgICAgICB2YXIgbGFzdDtcbiAgICAgICAgICAgICAgICB2YXIgZGVmZXJUaW1lcjtcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29udGV4dCA9IHNjb3BlIHx8IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub3cgPSArbmV3IERhdGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgICAgICAgICAgICAgICBpZiAobGFzdCAmJiBub3cgPCBsYXN0ICsgdGhyZXNoaG9sZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaG9sZCBvbiB0byBpdFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGRlZmVyVGltZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3QgPSBub3c7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRocmVzaGhvbGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdCA9IG5vdztcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBVdGlscztcbiAgICAgICAgfSgpKTtcbiAgICAgICAgZ2FtZS5VdGlscyA9IFV0aWxzO1xuICAgIH0pKGdhbWUgPSBhcHAuZ2FtZSB8fCAoYXBwLmdhbWUgPSB7fSkpO1xufSkoYXBwIHx8IChhcHAgPSB7fSkpO1xuXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiZGVmaW5pdGlvbnMvZ3JlZW5zb2NrL2dyZWVuc29jay5kLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJVdGlscy50c1wiIC8+XG52YXIgYXBwO1xuKGZ1bmN0aW9uIChhcHApIHtcbiAgICB2YXIgZ2FtZTtcbiAgICAoZnVuY3Rpb24gKGdhbWUpIHtcbiAgICAgICAgdmFyIFV0aWxzID0gYXBwLmdhbWUuVXRpbHM7XG4gICAgICAgIHZhciBQbGF5ZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gUGxheWVyKHBsYXlBcmVhLCBlbGVtZW50TmFtZSkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpcy5faXNKdW1waW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG9vdCA9IFV0aWxzLnRocm90dGxlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLmlzRGVhZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMubXNnRGVhZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBidWxsZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICAgICAgYnVsbGV0LmNsYXNzTmFtZSA9ICdidWxsZXQnO1xuICAgICAgICAgICAgICAgICAgICBidWxsZXQuc3R5bGUud2lkdGggPSAnMTBweCc7XG4gICAgICAgICAgICAgICAgICAgIGJ1bGxldC5zdHlsZS5oZWlnaHQgPSAnMTBweCc7XG4gICAgICAgICAgICAgICAgICAgIGJ1bGxldC5zdHlsZS5ib3R0b20gPSBwYXJzZUludChfdGhpcy5ib2R5LnN0eWxlLmJvdHRvbSkgKyAyNSArICdweCc7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnBsYXlBcmVhLmFwcGVuZENoaWxkKGJ1bGxldCk7XG4gICAgICAgICAgICAgICAgICAgIFR3ZWVuTGl0ZS50byhidWxsZXQsIDUuNzUsIHsgcmlnaHQ6IC0yMCwgb25Db21wbGV0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFR3ZWVuTWF4LmtpbGxUd2VlbnNPZihidWxsZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnBsYXlBcmVhLnJlbW92ZUNoaWxkKGJ1bGxldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IH0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc2hvb3QnKTtcbiAgICAgICAgICAgICAgICB9LCA1MDApO1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlGb3JjZSA9IFV0aWxzLnRocm90dGxlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLmlzRGVhZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMubXNnRGVhZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmZvcmNlSnVtcCA9IF90aGlzLmZvcmNlSnVtcCA8IDEgPyBfdGhpcy5mb3JjZUp1bXAgKyAwLjEgOiAxO1xuICAgICAgICAgICAgICAgICAgICBUd2Vlbk1heC5raWxsVHdlZW5zT2YoX3RoaXMuYm9keSk7XG4gICAgICAgICAgICAgICAgICAgIFR3ZWVuTWF4LnRvKF90aGlzLmJvZHksIDAuMjUsIHsgaGVpZ2h0OiA1MCAtICgyMCAqIF90aGlzLmZvcmNlSnVtcCkgfSk7XG4gICAgICAgICAgICAgICAgfSwgMSk7XG4gICAgICAgICAgICAgICAgdGhpcy5qdW1wID0gVXRpbHMuZGVib3VuY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaXNKdW1waW5nIHx8IF90aGlzLmlzRGVhZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMubXNnRGVhZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmlzSnVtcGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIFR3ZWVuTWF4LnRvKF90aGlzLmJvZHksIDIgKiBfdGhpcy5mb3JjZUp1bXAsIHsgaGVpZ2h0OiAnODBweCcsIGJvdHRvbTogNDIwICogX3RoaXMuZm9yY2VKdW1wLCBvbkNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVHdlZW5NYXgudG8oX3RoaXMuYm9keSwgMS42ICogX3RoaXMuZm9yY2VKdW1wLCB7IGhlaWdodDogJzUwcHgnLCBib3R0b206IDAsIG9uQ29tcGxldGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmlzSnVtcGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZm9yY2VKdW1wID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gfSk7XG4gICAgICAgICAgICAgICAgfSwgMjUwKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBsYXlBcmVhID0gcGxheUFyZWE7XG4gICAgICAgICAgICAgICAgdGhpcy5ib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWxlbWVudE5hbWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuYm9keS5zdHlsZS5ib3R0b20gPSAnMHB4JztcbiAgICAgICAgICAgICAgICB0aGlzLmJvZHkuc3R5bGUud2lkdGggPSAnNTBweCc7XG4gICAgICAgICAgICAgICAgdGhpcy5ib2R5LnN0eWxlLmhlaWdodCA9ICc1MHB4JztcbiAgICAgICAgICAgICAgICB0aGlzLmJvZHkuc3R5bGUucmlnaHQgPSAnNzA4cHgnOyAvL3BvcnF1ZSBubyBsZWZ0PyBwYXJhIGNvbXBhcmFyIGNvbiAncmlnaHQnIGRlIG9ic3RhY3Vsb3MgbyBlbmVtaWdvc1xuICAgICAgICAgICAgICAgIHRoaXMuZm9yY2VKdW1wID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLmlzRGVhZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgUGxheWVyLnByb3RvdHlwZS5tc2dEZWFkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFU1RBUyBNVUVSVE8hIE5vIHRlIHB1ZWRlcyBqdWdhciBtYXMhLicpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFBsYXllci5wcm90b3R5cGUuZGVhZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzRGVhZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5ib2R5LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdibGFjayc7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1lPVSBESUUhISEhJyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBsYXllci5wcm90b3R5cGUsIFwiaXNKdW1waW5nXCIsIHtcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX2lzSnVtcGluZzsgfSxcbiAgICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIChpc0p1bXBpbmcpIHsgdGhpcy5faXNKdW1waW5nID0gaXNKdW1waW5nOyB9LFxuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBQbGF5ZXI7XG4gICAgICAgIH0oKSk7XG4gICAgICAgIGdhbWUuUGxheWVyID0gUGxheWVyO1xuICAgIH0pKGdhbWUgPSBhcHAuZ2FtZSB8fCAoYXBwLmdhbWUgPSB7fSkpO1xufSkoYXBwIHx8IChhcHAgPSB7fSkpO1xuXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiUGxheWVyLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJJUmVjdC50c1wiIC8+XG52YXIgYXBwO1xuKGZ1bmN0aW9uIChhcHApIHtcbiAgICB2YXIgZ2FtZTtcbiAgICAoZnVuY3Rpb24gKGdhbWUpIHtcbiAgICAgICAgdmFyIFRpY2tlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBUaWNrZXIocGxheUFyZWEsIHBsYXllcikge1xuICAgICAgICAgICAgICAgIHRoaXMucGxheWVyID0gcGxheWVyO1xuICAgICAgICAgICAgICAgIHRoaXMucGxheUFyZWEgPSBwbGF5QXJlYTtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBUaWNrZXIucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVjdFBsYXllciA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHBhcnNlSW50KF90aGlzLnBsYXllci5ib2R5LnN0eWxlLnJpZ2h0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHBhcnNlSW50KF90aGlzLnBsYXllci5ib2R5LnN0eWxlLmJvdHRvbSksXG4gICAgICAgICAgICAgICAgICAgICAgICB3OiBwYXJzZUludChfdGhpcy5wbGF5ZXIuYm9keS5zdHlsZS53aWR0aCksXG4gICAgICAgICAgICAgICAgICAgICAgICBoOiBwYXJzZUludChfdGhpcy5wbGF5ZXIuYm9keS5zdHlsZS5oZWlnaHQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZTogX3RoaXMucGxheWVyLmJvZHlcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVuZW1pZXMgPSBfdGhpcy5wbGF5QXJlYS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdlbmVteScpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZW5lbWllcy5sZW5ndGggPiAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbmVtaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsRW5lbXkgPSBlbmVtaWVzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWN0MSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeDogcGFyc2VJbnQoZWxFbmVteS5zdHlsZS5yaWdodCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHk6IHBhcnNlSW50KGVsRW5lbXkuc3R5bGUuYm90dG9tKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdzogcGFyc2VJbnQoZWxFbmVteS5zdHlsZS53aWR0aCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGg6IHBhcnNlSW50KGVsRW5lbXkuc3R5bGUuaGVpZ2h0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZTogZWxFbmVteVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdhbWUuVXRpbHMuZGV0ZWN0Q29sbGl0aW9uKHJlY3QxLCByZWN0UGxheWVyKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlBPVyFcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnBsYXllci5kZWFkKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgb2JzdGFjbGVzID0gX3RoaXMucGxheUFyZWEuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnb2JzdGFjbGUnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9ic3RhY2xlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9ic3RhY2xlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbE9ic3RhY2xlID0gb2JzdGFjbGVzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWN0MSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeDogcGFyc2VJbnQoZWxPYnN0YWNsZS5zdHlsZS5yaWdodCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHk6IHBhcnNlSW50KGVsT2JzdGFjbGUuc3R5bGUuYm90dG9tKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdzogcGFyc2VJbnQoZWxPYnN0YWNsZS5zdHlsZS53aWR0aCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGg6IHBhcnNlSW50KGVsT2JzdGFjbGUuc3R5bGUuaGVpZ2h0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZTogZWxPYnN0YWNsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFfdGhpcy5wbGF5ZXIuaXNEZWFkICYmIGdhbWUuVXRpbHMuZGV0ZWN0Q29sbGl0aW9uKHJlY3QxLCByZWN0UGxheWVyKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlBBTSFcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnBsYXllci5kZWFkKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBidWxsZXRzID0gX3RoaXMucGxheUFyZWEuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYnVsbGV0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJ1bGxldHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJ1bGxldHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbEJ1bGxldCA9IGJ1bGxldHNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVjdDIgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeDogcGFyc2VJbnQoZWxCdWxsZXQuc3R5bGUucmlnaHQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHk6IHBhcnNlSW50KGVsQnVsbGV0LnN0eWxlLmJvdHRvbSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdzogcGFyc2VJbnQoZWxCdWxsZXQuc3R5bGUud2lkdGgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGg6IHBhcnNlSW50KGVsQnVsbGV0LnN0eWxlLmhlaWdodCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZTogZWxCdWxsZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2FtZS5VdGlscy5kZXRlY3RDb2xsaXRpb24ocmVjdDEsIHJlY3QyKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ1JBU0ghXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFR3ZWVuTWF4LmtpbGxUd2VlbnNPZihyZWN0MS5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wbGF5QXJlYS5yZW1vdmVDaGlsZChyZWN0MS5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUd2Vlbk1heC5raWxsVHdlZW5zT2YocmVjdDIuZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucGxheUFyZWEucmVtb3ZlQ2hpbGQocmVjdDIuZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCAxKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gVGlja2VyO1xuICAgICAgICB9KCkpO1xuICAgICAgICBnYW1lLlRpY2tlciA9IFRpY2tlcjtcbiAgICB9KShnYW1lID0gYXBwLmdhbWUgfHwgKGFwcC5nYW1lID0ge30pKTtcbn0pKGFwcCB8fCAoYXBwID0ge30pKTtcblxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkFic3RyYWN0LnRzXCIgLz5cbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHtcbiAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTtcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG59O1xudmFyIGFwcDtcbihmdW5jdGlvbiAoYXBwKSB7XG4gICAgdmFyIGdhbWU7XG4gICAgKGZ1bmN0aW9uIChnYW1lKSB7XG4gICAgICAgIHZhciBFbmVteSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgICAgICBfX2V4dGVuZHMoRW5lbXksIF9zdXBlcik7XG4gICAgICAgICAgICBmdW5jdGlvbiBFbmVteShwbGF5QXJlYSwgd2lkdGgsIGhlaWdodCwgdmVsb2NpdHkpIHtcbiAgICAgICAgICAgICAgICBpZiAod2lkdGggPT09IHZvaWQgMCkgeyB3aWR0aCA9IDEwOyB9XG4gICAgICAgICAgICAgICAgaWYgKGhlaWdodCA9PT0gdm9pZCAwKSB7IGhlaWdodCA9IDEwOyB9XG4gICAgICAgICAgICAgICAgaWYgKHZlbG9jaXR5ID09PSB2b2lkIDApIHsgdmVsb2NpdHkgPSAuNTsgfVxuICAgICAgICAgICAgICAgIF9zdXBlci5jYWxsKHRoaXMsIHBsYXlBcmVhLCB3aWR0aCwgaGVpZ2h0LCB2ZWxvY2l0eSk7XG4gICAgICAgICAgICAgICAgdGhpcy5ib2R5LnN0eWxlLmJvdHRvbSA9ICcwJztcbiAgICAgICAgICAgICAgICB0aGlzLmJvZHkuY2xhc3NOYW1lID0gJ2VuZW15JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBFbmVteTtcbiAgICAgICAgfShhcHAuZ2FtZS5BYnN0cmFjdCkpO1xuICAgICAgICBnYW1lLkVuZW15ID0gRW5lbXk7XG4gICAgfSkoZ2FtZSA9IGFwcC5nYW1lIHx8IChhcHAuZ2FtZSA9IHt9KSk7XG59KShhcHAgfHwgKGFwcCA9IHt9KSk7XG5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJBYnN0cmFjdC50c1wiIC8+XG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07XG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xufTtcbnZhciBhcHA7XG4oZnVuY3Rpb24gKGFwcCkge1xuICAgIHZhciBnYW1lO1xuICAgIChmdW5jdGlvbiAoZ2FtZSkge1xuICAgICAgICB2YXIgT2JzdGFjbGUgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICAgICAgX19leHRlbmRzKE9ic3RhY2xlLCBfc3VwZXIpO1xuICAgICAgICAgICAgZnVuY3Rpb24gT2JzdGFjbGUocGxheUFyZWEsIHdpZHRoLCBoZWlnaHQsIHZlbG9jaXR5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHdpZHRoID09PSB2b2lkIDApIHsgd2lkdGggPSAxMDsgfVxuICAgICAgICAgICAgICAgIGlmIChoZWlnaHQgPT09IHZvaWQgMCkgeyBoZWlnaHQgPSAxMDsgfVxuICAgICAgICAgICAgICAgIGlmICh2ZWxvY2l0eSA9PT0gdm9pZCAwKSB7IHZlbG9jaXR5ID0gLjU7IH1cbiAgICAgICAgICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBwbGF5QXJlYSwgd2lkdGgsIGhlaWdodCwgdmVsb2NpdHkpO1xuICAgICAgICAgICAgICAgIHRoaXMuYm9keS5zdHlsZS5ib3R0b20gPSAoNTAwIC0gdGhpcy5oZWlnaHQpICsgJ3B4JzsgLy8gcG9ycXVlIG5vIHRvcD8gcGFyYSBjb21wYXJhciBjb24gZWwgYm90dG9tIGRlIHBsYXllclxuICAgICAgICAgICAgICAgIHRoaXMuYm9keS5jbGFzc05hbWUgPSAnb2JzdGFjbGUnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIE9ic3RhY2xlO1xuICAgICAgICB9KGFwcC5nYW1lLkFic3RyYWN0KSk7XG4gICAgICAgIGdhbWUuT2JzdGFjbGUgPSBPYnN0YWNsZTtcbiAgICB9KShnYW1lID0gYXBwLmdhbWUgfHwgKGFwcC5nYW1lID0ge30pKTtcbn0pKGFwcCB8fCAoYXBwID0ge30pKTtcblxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkVuZW15LnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJPYnN0YWNsZS50c1wiIC8+XG4vLyBEZWZpbmljacOzbiBkZSBuaXZlbGVzXG52YXIgbGV2ZWxzID0gW1xuICAgIC8qMSovXG4gICAgW1xuICAgICAgICB7XG4gICAgICAgICAgICB0eXBlOiAnb2JzdGFjbGUnLFxuICAgICAgICAgICAgdGltZTogLjIsXG4gICAgICAgICAgICB3aWR0aDogMTAsXG4gICAgICAgICAgICBoZWlnaHQ6IDUwMCxcbiAgICAgICAgICAgIHZlbG9jaXR5OiA1LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICB0eXBlOiAnb2JzdGFjbGUnLFxuICAgICAgICAgICAgdGltZTogMyxcbiAgICAgICAgICAgIHdpZHRoOiAxMCxcbiAgICAgICAgICAgIGhlaWdodDogNDAwLFxuICAgICAgICAgICAgdmVsb2NpdHk6IDUsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6ICdvYnN0YWNsZScsXG4gICAgICAgICAgICB0aW1lOiA2LFxuICAgICAgICAgICAgd2lkdGg6IDEwLFxuICAgICAgICAgICAgaGVpZ2h0OiAxMjAsXG4gICAgICAgICAgICB2ZWxvY2l0eTogNSxcbiAgICAgICAgfVxuICAgIF0sXG4gICAgLyoyKi9cbiAgICBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6ICdlbmVteScsXG4gICAgICAgICAgICB0aW1lOiAwLjIsXG4gICAgICAgICAgICB3aWR0aDogMTAsXG4gICAgICAgICAgICBoZWlnaHQ6IDMwMCxcbiAgICAgICAgICAgIHZlbG9jaXR5OiA1LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICB0eXBlOiAnb2JzdGFjbGUnLFxuICAgICAgICAgICAgdGltZTogMixcbiAgICAgICAgICAgIHdpZHRoOiAxMCxcbiAgICAgICAgICAgIGhlaWdodDogMTAwLFxuICAgICAgICAgICAgdmVsb2NpdHk6IDMsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6ICdvYnN0YWNsZScsXG4gICAgICAgICAgICB0aW1lOiA1LFxuICAgICAgICAgICAgd2lkdGg6IDIwLFxuICAgICAgICAgICAgaGVpZ2h0OiA0MzAsXG4gICAgICAgICAgICB2ZWxvY2l0eTogNCxcbiAgICAgICAgfVxuICAgIF0sXG4gICAgLyozKi9cbiAgICBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6ICdvYnN0YWNsZScsXG4gICAgICAgICAgICB0aW1lOiAuMixcbiAgICAgICAgICAgIHdpZHRoOiAxMCxcbiAgICAgICAgICAgIGhlaWdodDogMjAwLFxuICAgICAgICAgICAgdmVsb2NpdHk6IDUsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6ICdlbmVteScsXG4gICAgICAgICAgICB0aW1lOiAuMixcbiAgICAgICAgICAgIHdpZHRoOiAxMCxcbiAgICAgICAgICAgIGhlaWdodDogMjAwLFxuICAgICAgICAgICAgdmVsb2NpdHk6IDUsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6ICdvYnN0YWNsZScsXG4gICAgICAgICAgICB0aW1lOiA1LjIsXG4gICAgICAgICAgICB3aWR0aDogMTAsXG4gICAgICAgICAgICBoZWlnaHQ6IDM1MCxcbiAgICAgICAgICAgIHZlbG9jaXR5OiA1LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICB0eXBlOiAnZW5lbXknLFxuICAgICAgICAgICAgdGltZTogNS4yLFxuICAgICAgICAgICAgd2lkdGg6IDEwLFxuICAgICAgICAgICAgaGVpZ2h0OiAxMDAsXG4gICAgICAgICAgICB2ZWxvY2l0eTogNSxcbiAgICAgICAgfSxcbiAgICBdLFxuXTtcbnZhciBhcHA7XG4oZnVuY3Rpb24gKGFwcCkge1xuICAgIHZhciBnYW1lO1xuICAgIChmdW5jdGlvbiAoZ2FtZSkge1xuICAgICAgICB2YXIgRW5lbXkgPSBhcHAuZ2FtZS5FbmVteTtcbiAgICAgICAgdmFyIE9ic3RhY2xlID0gYXBwLmdhbWUuT2JzdGFjbGU7XG4gICAgICAgIHZhciBMZXZlbFNlbGVjdG9yID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIExldmVsU2VsZWN0b3IocGxheUFyZWEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsYXlBcmVhID0gcGxheUFyZWE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBDYXJnYSB1biBuaXZlbCFcbiAgICAgICAgICAgIExldmVsU2VsZWN0b3IucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAobHZsKSB7XG4gICAgICAgICAgICAgICAgaWYgKGx2bCA9PT0gdm9pZCAwKSB7IGx2bCA9IDA7IH1cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTG9hZCBMVkwgLT4gJywgbHZsKTtcbiAgICAgICAgICAgICAgICBpZiAobHZsIDwgMSB8fCBsdmwgPiBsZXZlbHMubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgbHZsID0gbHZsIC0gMTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxldmVsc1tsdmxdLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGxldmVsc1tsdmxdW2ldO1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqZWN0O1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHZhbHVlLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2VuZW15JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QgPSBuZXcgRW5lbXkodGhpcy5wbGF5QXJlYSwgdmFsdWUud2lkdGgsIHZhbHVlLmhlaWdodCwgdmFsdWUudmVsb2NpdHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnb2JzdGFjbGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCA9IG5ldyBPYnN0YWNsZSh0aGlzLnBsYXlBcmVhLCB2YWx1ZS53aWR0aCwgdmFsdWUuaGVpZ2h0LCB2YWx1ZS52ZWxvY2l0eSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0LnJlbGVhc2UodmFsdWUudGltZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBMZXZlbFNlbGVjdG9yO1xuICAgICAgICB9KCkpO1xuICAgICAgICBnYW1lLkxldmVsU2VsZWN0b3IgPSBMZXZlbFNlbGVjdG9yO1xuICAgIH0pKGdhbWUgPSBhcHAuZ2FtZSB8fCAoYXBwLmdhbWUgPSB7fSkpO1xufSkoYXBwIHx8IChhcHAgPSB7fSkpO1xuXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiUGxheWVyLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJUaWNrZXIudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkxldmVsU2VsZWN0b3IudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIlV0aWxzLnRzXCIgLz5cbnZhciBhcHA7XG4oZnVuY3Rpb24gKGFwcCkge1xuICAgIHZhciBnYW1lO1xuICAgIChmdW5jdGlvbiAoZ2FtZSkge1xuICAgICAgICB2YXIgUGxheWVyID0gYXBwLmdhbWUuUGxheWVyO1xuICAgICAgICB2YXIgVGlja2VyID0gYXBwLmdhbWUuVGlja2VyO1xuICAgICAgICB2YXIgTGV2ZWxTZWxlY3RvciA9IGFwcC5nYW1lLkxldmVsU2VsZWN0b3I7XG4gICAgICAgIHZhciBBcHAgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gQXBwKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYnRQbGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2pzLWJ0LXBsYXknKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJ0UmVsb2FkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2pzLWJ0LXJlbG9hZCcpO1xuICAgICAgICAgICAgICAgIHRoaXMucGxheUFyZWEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnanMtY2FudmFzJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXIgPSBuZXcgUGxheWVyKHRoaXMucGxheUFyZWEsICdqcy1wbGF5ZXInKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRpY2tlciA9IG5ldyBUaWNrZXIodGhpcy5wbGF5QXJlYSwgdGhpcy5wbGF5ZXIpO1xuICAgICAgICAgICAgICAgIHRoaXMubGV2ZWxTZWxlY3RvciA9IG5ldyBMZXZlbFNlbGVjdG9yKHRoaXMucGxheUFyZWEpO1xuICAgICAgICAgICAgICAgIHRoaXMuaXNQbGF5aW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBBcHAucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYmluZGluZ3MoKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBBcHAucHJvdG90eXBlLmJpbmRpbmdzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpcy5idFBsYXkub25jbGljayA9IHRoaXMucGxheS5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgICAgIHRoaXMuYnRSZWxvYWQub25jbGljayA9IHRoaXMucmVsb2FkLmJpbmQodGhpcyk7XG4gICAgICAgICAgICAgICAgLy8gQ29udHJvbGVzIHBsYXllclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkub25rZXlkb3duID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGUud2hpY2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vbGV0cmEgaiAoZnVlcnphKVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA3NDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIV90aGlzLnBsYXllci5pc0p1bXBpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucGxheWVyLmFwcGx5Rm9yY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2xldHJhIGYgKGRpc3BhcmEpXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDcwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnBsYXllci5zaG9vdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5Lm9ua2V5dXAgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIC8vbGV0cmEgaiAoc2FsdGEpXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLndoaWNoID09IDc0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wbGF5ZXIuanVtcCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBBcHAucHJvdG90eXBlLnJlbG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBBcHAucHJvdG90eXBlLnBsYXkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWxlYXNlTGV2ZWxzKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgQXBwLnByb3RvdHlwZS5yZWxlYXNlTGV2ZWxzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNQbGF5aW5nKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5sZXZlbFNlbGVjdG9yLmxvYWQoMSk7XG4gICAgICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubGV2ZWxTZWxlY3Rvci5sb2FkKDIpO1xuICAgICAgICAgICAgICAgIH0sIDEyMDAwKTtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubGV2ZWxTZWxlY3Rvci5sb2FkKDMpO1xuICAgICAgICAgICAgICAgIH0sIDIwMDAwKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gQXBwO1xuICAgICAgICB9KCkpO1xuICAgICAgICBnYW1lLkFwcCA9IEFwcDtcbiAgICB9KShnYW1lID0gYXBwLmdhbWUgfHwgKGFwcC5nYW1lID0ge30pKTtcbn0pKGFwcCB8fCAoYXBwID0ge30pKTtcblxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkFwcC50c1wiIC8+XG52YXIgQXBwID0gYXBwLmdhbWUuQXBwO1xudmFyIHdhbGtBbG9uZUFwcDtcbihmdW5jdGlvbiAoKSB7XG4gICAgd2Fsa0Fsb25lQXBwID0gbmV3IEFwcCgpO1xuICAgIHdhbGtBbG9uZUFwcC5zdGFydCgpO1xufSkoKTtcbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJQbGF5ZXIudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIklSZWN0LnRzXCIgLz5cblxuXG5tb2R1bGUgYXBwLmdhbWUge1xuICAgIFxuICAgIGltcG9ydCBJUmVjdCA9IGFwcC5nYW1lLklSZWN0O1xuICAgIFxuICAgIGV4cG9ydCBjbGFzcyBUaWNrZXIge1xuICAgICAgICBcbiAgICAgICAgcHJpdmF0ZSBwbGF5ZXI6IGFwcC5nYW1lLlBsYXllcjtcbiAgICAgICAgcHJpdmF0ZSBwbGF5QXJlYTogSFRNTEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0cnVjdG9yKCBwbGF5QXJlYTogSFRNTEVsZW1lbnQsIHBsYXllcjogYXBwLmdhbWUuUGxheWVyICkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLnBsYXllciA9IHBsYXllcjtcbiAgICAgICAgICAgIHRoaXMucGxheUFyZWEgPSBwbGF5QXJlYTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5zdGFydCgpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBwcml2YXRlIHN0YXJ0ICgpOiB2b2lkIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgc2V0SW50ZXJ2YWwoICgpID0+IHtcblx0XHRcbiAgICAgICAgICAgICAgICB2YXIgcmVjdFBsYXllciA9IDxJUmVjdD4ge1xuICAgICAgICAgICAgICAgICAgICB4OiBwYXJzZUludCh0aGlzLnBsYXllci5ib2R5LnN0eWxlLnJpZ2h0KSxcbiAgICAgICAgICAgICAgICAgICAgeTogcGFyc2VJbnQodGhpcy5wbGF5ZXIuYm9keS5zdHlsZS5ib3R0b20pLFxuICAgICAgICAgICAgICAgICAgICB3OiBwYXJzZUludCh0aGlzLnBsYXllci5ib2R5LnN0eWxlLndpZHRoKSxcbiAgICAgICAgICAgICAgICAgICAgaDogcGFyc2VJbnQodGhpcy5wbGF5ZXIuYm9keS5zdHlsZS5oZWlnaHQpLFxuICAgICAgICAgICAgICAgICAgICBlOiB0aGlzLnBsYXllci5ib2R5XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBlbmVtaWVzID0gdGhpcy5wbGF5QXJlYS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdlbmVteScpO1xuICAgICAgICAgICAgICAgIGlmKGVuZW1pZXMubGVuZ3RoID4gMClcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbmVtaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxFbmVteTogYW55ID0gZW5lbWllc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWN0MSA9IDxJUmVjdD4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHg6IHBhcnNlSW50KGVsRW5lbXkuc3R5bGUucmlnaHQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHk6IHBhcnNlSW50KGVsRW5lbXkuc3R5bGUuYm90dG9tKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3OiBwYXJzZUludChlbEVuZW15LnN0eWxlLndpZHRoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoOiBwYXJzZUludChlbEVuZW15LnN0eWxlLmhlaWdodCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZTogZWxFbmVteVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggVXRpbHMuZGV0ZWN0Q29sbGl0aW9uKHJlY3QxLCByZWN0UGxheWVyKSApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCBcIlBPVyFcIiApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGxheWVyLmRlYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgb2JzdGFjbGVzID0gdGhpcy5wbGF5QXJlYS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdvYnN0YWNsZScpO1xuICAgICAgICAgICAgICAgIGlmKG9ic3RhY2xlcy5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvYnN0YWNsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbE9ic3RhY2xlOiBhbnkgPSBvYnN0YWNsZXNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVjdDEgPSA8SVJlY3Q+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4OiBwYXJzZUludChlbE9ic3RhY2xlLnN0eWxlLnJpZ2h0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5OiBwYXJzZUludChlbE9ic3RhY2xlLnN0eWxlLmJvdHRvbSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdzogcGFyc2VJbnQoZWxPYnN0YWNsZS5zdHlsZS53aWR0aCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaDogcGFyc2VJbnQoZWxPYnN0YWNsZS5zdHlsZS5oZWlnaHQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGU6IGVsT2JzdGFjbGVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoICF0aGlzLnBsYXllci5pc0RlYWQgJiYgVXRpbHMuZGV0ZWN0Q29sbGl0aW9uKHJlY3QxLCByZWN0UGxheWVyKSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggXCJQQU0hXCIgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXllci5kZWFkKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJ1bGxldHMgPSB0aGlzLnBsYXlBcmVhLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2J1bGxldCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoYnVsbGV0cy5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJ1bGxldHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsQnVsbGV0OiBhbnkgPSBidWxsZXRzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVjdDIgPSA8SVJlY3Q+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHg6IHBhcnNlSW50KGVsQnVsbGV0LnN0eWxlLnJpZ2h0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHk6IHBhcnNlSW50KGVsQnVsbGV0LnN0eWxlLmJvdHRvbSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3OiBwYXJzZUludChlbEJ1bGxldC5zdHlsZS53aWR0aCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoOiBwYXJzZUludChlbEJ1bGxldC5zdHlsZS5oZWlnaHQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZTogZWxCdWxsZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIFV0aWxzLmRldGVjdENvbGxpdGlvbihyZWN0MSwgcmVjdDIpICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggXCJDUkFTSCFcIiApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVHdlZW5NYXgua2lsbFR3ZWVuc09mKCByZWN0MS5lICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXlBcmVhLnJlbW92ZUNoaWxkKCByZWN0MS5lICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFR3ZWVuTWF4LmtpbGxUd2VlbnNPZiggcmVjdDIuZSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5QXJlYS5yZW1vdmVDaGlsZCggcmVjdDIuZSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgMSApO1xuICAgICAgICB9XG4gICAgfVxufSIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJBYnN0cmFjdC50c1wiIC8+XG5cbm1vZHVsZSBhcHAuZ2FtZSB7XG4gICAgXG4gICAgZXhwb3J0IGNsYXNzIEVuZW15IGV4dGVuZHMgYXBwLmdhbWUuQWJzdHJhY3Qge1xuICAgICAgICBcbiAgICAgICAgY29uc3RydWN0b3IoIHBsYXlBcmVhOiBIVE1MRWxlbWVudCwgd2lkdGg6IG51bWJlciA9IDEwLCBoZWlnaHQ6IG51bWJlciA9IDEwLCB2ZWxvY2l0eTogbnVtYmVyID0gLjUgKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHN1cGVyKCBwbGF5QXJlYSx3aWR0aCwgaGVpZ2h0LCB2ZWxvY2l0eSApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLmJvZHkuc3R5bGUuYm90dG9tID0gJzAnO1xuICAgICAgICAgICAgdGhpcy5ib2R5LmNsYXNzTmFtZSA9ICdlbmVteSc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfVxufSIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJBYnN0cmFjdC50c1wiIC8+XG5cbm1vZHVsZSBhcHAuZ2FtZSB7XG4gICAgXG4gICAgZXhwb3J0IGNsYXNzIE9ic3RhY2xlIGV4dGVuZHMgYXBwLmdhbWUuQWJzdHJhY3Qge1xuICAgICAgICBcbiAgICAgICAgY29uc3RydWN0b3IoIHBsYXlBcmVhOiBIVE1MRWxlbWVudCwgd2lkdGg6IG51bWJlciA9IDEwLCBoZWlnaHQ6IG51bWJlciA9IDEwLCB2ZWxvY2l0eTogbnVtYmVyID0gLjUgKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHN1cGVyKCBwbGF5QXJlYSx3aWR0aCwgaGVpZ2h0LCB2ZWxvY2l0eSApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLmJvZHkuc3R5bGUuYm90dG9tID0gKDUwMCAtIHRoaXMuaGVpZ2h0KSArICdweCc7IC8vIHBvcnF1ZSBubyB0b3A/IHBhcmEgY29tcGFyYXIgY29uIGVsIGJvdHRvbSBkZSBwbGF5ZXJcbiAgICAgICAgICAgIHRoaXMuYm9keS5jbGFzc05hbWUgPSAnb2JzdGFjbGUnO1xuICAgICAgICB9XG4gICAgfVxufSIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJFbmVteS50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiT2JzdGFjbGUudHNcIiAvPlxuXG4vLyBEZWZpbmljacOzbiBkZSBuaXZlbGVzXG52YXIgbGV2ZWxzID0gW1xuXHQvKjEqL1xuXHRbXG5cdFx0e1xuXHRcdFx0dHlwZTogJ29ic3RhY2xlJyxcblx0XHRcdHRpbWU6IC4yLFxuXHRcdFx0d2lkdGg6IDEwLFxuXHRcdFx0aGVpZ2h0OiA1MDAsXG5cdFx0XHR2ZWxvY2l0eTogNSxcblx0XHR9LFxuXHRcdHtcblx0XHRcdHR5cGU6ICdvYnN0YWNsZScsXG5cdFx0XHR0aW1lOiAzLFxuXHRcdFx0d2lkdGg6IDEwLFxuXHRcdFx0aGVpZ2h0OiA0MDAsXG5cdFx0XHR2ZWxvY2l0eTogNSxcblx0XHR9LFxuXHRcdHtcblx0XHRcdHR5cGU6ICdvYnN0YWNsZScsXG5cdFx0XHR0aW1lOiA2LFxuXHRcdFx0d2lkdGg6IDEwLFxuXHRcdFx0aGVpZ2h0OiAxMjAsXG5cdFx0XHR2ZWxvY2l0eTogNSxcblx0XHR9XG5cdF0sXG5cdC8qMiovXG5cdFtcblx0XHR7XG5cdFx0XHR0eXBlOiAnZW5lbXknLFxuXHRcdFx0dGltZTogMC4yLFxuXHRcdFx0d2lkdGg6IDEwLFxuXHRcdFx0aGVpZ2h0OiAzMDAsXG5cdFx0XHR2ZWxvY2l0eTogNSxcblx0XHR9LFxuXHRcdHtcblx0XHRcdHR5cGU6ICdvYnN0YWNsZScsXG5cdFx0XHR0aW1lOiAyLFxuXHRcdFx0d2lkdGg6IDEwLFxuXHRcdFx0aGVpZ2h0OiAxMDAsXG5cdFx0XHR2ZWxvY2l0eTogMyxcblx0XHR9LFxuXHRcdHtcblx0XHRcdHR5cGU6ICdvYnN0YWNsZScsXG5cdFx0XHR0aW1lOiA1LFxuXHRcdFx0d2lkdGg6IDIwLFxuXHRcdFx0aGVpZ2h0OiA0MzAsXG5cdFx0XHR2ZWxvY2l0eTogNCxcblx0XHR9XG5cdF0sXG5cdFxuXHQvKjMqL1xuXHRbXG5cdFx0e1xuXHRcdFx0dHlwZTogJ29ic3RhY2xlJyxcblx0XHRcdHRpbWU6IC4yLFxuXHRcdFx0d2lkdGg6IDEwLFxuXHRcdFx0aGVpZ2h0OiAyMDAsXG5cdFx0XHR2ZWxvY2l0eTogNSxcblx0XHR9LFxuXHRcdHtcblx0XHRcdHR5cGU6ICdlbmVteScsXG5cdFx0XHR0aW1lOiAuMixcblx0XHRcdHdpZHRoOiAxMCxcblx0XHRcdGhlaWdodDogMjAwLFxuXHRcdFx0dmVsb2NpdHk6IDUsXG5cdFx0fSxcblx0XHRcblx0XHR7XG5cdFx0XHR0eXBlOiAnb2JzdGFjbGUnLFxuXHRcdFx0dGltZTogNS4yLFxuXHRcdFx0d2lkdGg6IDEwLFxuXHRcdFx0aGVpZ2h0OiAzNTAsXG5cdFx0XHR2ZWxvY2l0eTogNSxcblx0XHR9LFxuXHRcdHtcblx0XHRcdHR5cGU6ICdlbmVteScsXG5cdFx0XHR0aW1lOiA1LjIsXG5cdFx0XHR3aWR0aDogMTAsXG5cdFx0XHRoZWlnaHQ6IDEwMCxcblx0XHRcdHZlbG9jaXR5OiA1LFxuXHRcdH0sXG5cdF0sXG5dO1xuXG5tb2R1bGUgYXBwLmdhbWUge1xuICAgIFxuICAgIGltcG9ydCBFbmVteSA9IGFwcC5nYW1lLkVuZW15O1xuICAgIGltcG9ydCBPYnN0YWNsZSA9IGFwcC5nYW1lLk9ic3RhY2xlO1xuXG4gICAgZXhwb3J0IGNsYXNzIExldmVsU2VsZWN0b3Ige1xuICAgICAgICBcbiAgICAgICAgcHJpdmF0ZSBwbGF5QXJlYTogSFRNTEVsZW1lbnQ7XG4gICAgICAgIFxuICAgICAgICBjb25zdHJ1Y3RvciggcGxheUFyZWE6IEhUTUxFbGVtZW50ICkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLnBsYXlBcmVhID0gcGxheUFyZWE7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIENhcmdhIHVuIG5pdmVsIVxuICAgICAgICBsb2FkICggbHZsOiBudW1iZXIgPSAwKSA6IGJvb2xlYW4ge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnTG9hZCBMVkwgLT4gJywgbHZsKTtcbiAgICAgICAgICAgIGlmKCBsdmwgPCAxIHx8IGx2bCA+IGxldmVscy5sZW5ndGggKSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBsdmwgPSBsdmwgLSAxO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxldmVsc1sgbHZsIF0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBsZXZlbHNbIGx2bCBdWyBpIF07XG4gICAgICAgICAgICAgICAgdmFyIG9iamVjdDogRW5lbXkgfCBPYnN0YWNsZTtcblxuICAgICAgICAgICAgICAgIHN3aXRjaCAoIHZhbHVlLnR5cGUgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZW5lbXknOlxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0ID0gbmV3IEVuZW15KCB0aGlzLnBsYXlBcmVhLCB2YWx1ZS53aWR0aCwgdmFsdWUuaGVpZ2h0LCB2YWx1ZS52ZWxvY2l0eSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnb2JzdGFjbGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0ID0gbmV3IE9ic3RhY2xlKCB0aGlzLnBsYXlBcmVhLCB2YWx1ZS53aWR0aCwgdmFsdWUuaGVpZ2h0LCB2YWx1ZS52ZWxvY2l0eSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9iamVjdC5yZWxlYXNlKCB2YWx1ZS50aW1lICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxufSIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJQbGF5ZXIudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIlRpY2tlci50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiTGV2ZWxTZWxlY3Rvci50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiVXRpbHMudHNcIiAvPlxuXG5tb2R1bGUgYXBwLmdhbWUge1xuICAgIFxuICAgIGltcG9ydCBVdGlscyA9IGFwcC5nYW1lLlV0aWxzO1xuICAgIGltcG9ydCBQbGF5ZXIgPSBhcHAuZ2FtZS5QbGF5ZXI7XG4gICAgaW1wb3J0IFRpY2tlciA9IGFwcC5nYW1lLlRpY2tlcjtcbiAgICBpbXBvcnQgTGV2ZWxTZWxlY3RvciA9IGFwcC5nYW1lLkxldmVsU2VsZWN0b3I7XG5cbiAgICBleHBvcnQgY2xhc3MgQXBwIHtcbiAgICAgICAgXG4gICAgICAgIHByaXZhdGUgcGxheWVyOiBQbGF5ZXI7XG4gICAgICAgIHByaXZhdGUgdGlja2VyOiBUaWNrZXI7XG4gICAgICAgIHByaXZhdGUgbGV2ZWxTZWxlY3RvcjogTGV2ZWxTZWxlY3RvcjtcbiAgICAgICAgXG4gICAgICAgIHByaXZhdGUgaXNQbGF5aW5nOiBib29sZWFuO1xuICAgICAgICBcbiAgICAgICAgcHJpdmF0ZSBwbGF5QXJlYTogSFRNTEVsZW1lbnQ7XG4gICAgICAgIHByaXZhdGUgYnRQbGF5OiBIVE1MRWxlbWVudDtcbiAgICAgICAgcHJpdmF0ZSBidFJlbG9hZDogSFRNTEVsZW1lbnQ7XG4gICAgICAgIFxuICAgICAgICBjb25zdHJ1Y3Rvcigpe1xuXG4gICAgICAgICAgICB0aGlzLmJ0UGxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCAnanMtYnQtcGxheScgKTtcbiAgICAgICAgICAgIHRoaXMuYnRSZWxvYWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggJ2pzLWJ0LXJlbG9hZCcgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5wbGF5QXJlYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCAnanMtY2FudmFzJyApO1xuXHQgICAgICAgIHRoaXMucGxheWVyID0gbmV3IFBsYXllciggdGhpcy5wbGF5QXJlYSwgJ2pzLXBsYXllcicgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy50aWNrZXIgPSBuZXcgVGlja2VyKCB0aGlzLnBsYXlBcmVhLCB0aGlzLnBsYXllciApO1xuICAgICAgICAgICAgdGhpcy5sZXZlbFNlbGVjdG9yID0gbmV3IExldmVsU2VsZWN0b3IoIHRoaXMucGxheUFyZWEgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgc3RhcnQoKTp2b2lke1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLmJpbmRpbmdzKCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHByaXZhdGUgYmluZGluZ3MoKTogdm9pZCB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMuYnRQbGF5Lm9uY2xpY2sgPSB0aGlzLnBsYXkuYmluZCh0aGlzKTsgXG4gICAgICAgICAgICB0aGlzLmJ0UmVsb2FkLm9uY2xpY2sgPSB0aGlzLnJlbG9hZC5iaW5kKHRoaXMpOyBcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDb250cm9sZXMgcGxheWVyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5Lm9ua2V5ZG93biA9IChlKSA9PiB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHN3aXRjaCAoZS53aGljaCkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vbGV0cmEgaiAoZnVlcnphKVxuICAgICAgICAgICAgICAgICAgICBjYXNlIDc0OiBpZiggIXRoaXMucGxheWVyLmlzSnVtcGluZyApIHsgdGhpcy5wbGF5ZXIuYXBwbHlGb3JjZSgpOyB9IGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAvL2xldHJhIGYgKGRpc3BhcmEpXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzA6IHRoaXMucGxheWVyLnNob290KCk7IGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5Lm9ua2V5dXAgPSAoZSkgPT4ge1xuXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIC8vbGV0cmEgaiAoc2FsdGEpXG4gICAgICAgICAgICAgICAgaWYoIGUud2hpY2ggPT0gNzQpeyB0aGlzLnBsYXllci5qdW1wKCk7IH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHByaXZhdGUgcmVsb2FkICgpOiB2b2lkIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBwcml2YXRlIHBsYXkoKTogdm9pZCB7XG4gICAgICAgICAgICB0aGlzLnJlbGVhc2VMZXZlbHMoKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcHJpdmF0ZSByZWxlYXNlTGV2ZWxzKCk6IHZvaWQge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiggdGhpcy5pc1BsYXlpbmcgKSByZXR1cm5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5sZXZlbFNlbGVjdG9yLmxvYWQoMSk7XG4gICAgICAgICAgICB9LCAxMDAgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgc2V0VGltZW91dCggKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMubGV2ZWxTZWxlY3Rvci5sb2FkKDIpO1xuICAgICAgICAgICAgfSwgMTIwMDAgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgc2V0VGltZW91dCggKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMubGV2ZWxTZWxlY3Rvci5sb2FkKDMpO1xuICAgICAgICAgICAgfSwgMjAwMDAgKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiQXBwLnRzXCIgLz5cblxuaW1wb3J0IEFwcCA9IGFwcC5nYW1lLkFwcDtcbnZhciB3YWxrQWxvbmVBcHA6IEFwcDtcblxuKGZ1bmN0aW9uICgpIHtcblxuXHR3YWxrQWxvbmVBcHAgPSBuZXcgQXBwKCk7XG5cdHdhbGtBbG9uZUFwcC5zdGFydCgpO1xufSkoKTsiXX0=
